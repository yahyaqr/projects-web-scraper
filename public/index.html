<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Scraper</title>
    <link rel="stylesheet" href="styles.css" type="text/css">
</head>

<body>
    <h1>Web Scraper</h1>
    <form id="scraperForm" enctype="multipart/form-data">
        <label for="htmlFile">Upload HTML file to scrape:</label>
        <input type="file" id="htmlFile" accept=".html,.htm" required>

        <label>
            <input type="checkbox" id="goToInnerLinks"> Go to links inside the uploaded file
        </label>

        <div id="innerLinkSelectorContainer" style="display: none;">
            <label for="innerLinkSelector">Selector for inner links:</label>
            <input type="text" id="innerLinkSelector">
        </div>

        <h3>Data Selectors</h3>
        <div id="selectorInputs"></div>
        <button type="button" id="addSelector">Add Selector</button>

        <button type="submit">Start Scraping</button>
    </form>

    <h3>Mockup Preview</h3>
    <table id="previewTable" border="1" style="width: 100%; border-collapse: collapse; margin-top: 10px;">
        <thead>
            <tr>
                <!-- Headers will be added dynamically -->
            </tr>
        </thead>
        <tbody>
            <tr>
                <!-- Placeholder row 1 -->
            </tr>
            <tr>
                <!-- Placeholder row 2 -->
            </tr>
        </tbody>
    </table>

    <div id="result"></div>
    <div id="errorLog" style="margin-top: 20px; color: red;"></div>

    <script>
        const form = document.getElementById('scraperForm');
        const goToInnerLinksCheckbox = document.getElementById('goToInnerLinks');
        const innerLinkSelectorContainer = document.getElementById('innerLinkSelectorContainer');
        const selectorInputs = document.getElementById('selectorInputs');
        const addSelectorButton = document.getElementById('addSelector');
        const previewTable = document.getElementById('previewTable');
        const errorLogDiv = document.getElementById('errorLog');

        // Toggle inner link selector input visibility
        goToInnerLinksCheckbox.addEventListener('change', function () {
            innerLinkSelectorContainer.style.display = this.checked ? 'block' : 'none';
            updatePreview(); // Update preview when toggling
        });

        // Add selector input fields dynamically
        addSelectorButton.addEventListener('click', function () {
            const selectorInput = document.createElement('div');
            selectorInput.className = 'selectorInput';
            selectorInput.innerHTML = `
                <input type="text" placeholder="Selector name" required>
                <input type="text" placeholder="CSS Selector" required>
                <button type="button" onclick="this.parentElement.remove(); updatePreview();">Remove</button>
            `;
            selectorInputs.appendChild(selectorInput);
            updatePreview();
        });

        // Update the preview table dynamically
        function updatePreview() {
            const headers = [];
            document.querySelectorAll('.selectorInput input:nth-child(1)').forEach(input => {
                if (input.value.trim()) {
                    headers.push(input.value.trim());
                }
            });

            const thead = previewTable.querySelector('thead tr');
            const tbody = previewTable.querySelector('tbody');
            thead.innerHTML = ''; // Clear existing headers
            tbody.innerHTML = ''; // Clear existing rows

            // Add "Links" column if "Go to inner links" is checked
            if (goToInnerLinksCheckbox.checked) {
                headers.unshift('Links');
            }

            // Populate headers
            headers.forEach(header => {
                const th = document.createElement('th');
                th.textContent = header;
                thead.appendChild(th);
            });

            // Populate placeholder rows
            for (let i = 0; i < 2; i++) {
                const tr = document.createElement('tr');
                headers.forEach((header, index) => {
                    const td = document.createElement('td');
                    // Add "Placeholder link" if the column is "Links"
                    td.textContent = index === 0 && header === 'Links' ? 'Placeholder link' : 'Placeholder data';
                    tr.appendChild(td);
                });
                tbody.appendChild(tr);
            }
        }

        // Update preview table whenever input fields change
        selectorInputs.addEventListener('input', updatePreview);
    </script>
</body>

</html>